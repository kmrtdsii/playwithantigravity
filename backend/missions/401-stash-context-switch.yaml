id: "401-stash-context-switch"
title: "Emergency Hotfix"
description: "You're in the middle of a big refactoring when a critical bug is reported. Save your work, fix the bug, and resume where you left off."
difficulty:
  level: "advanced"
  stars: 3
skill: "stash"

setup:
  - "git init"
  - "git config user.name 'User'"
  - "git config user.email 'user@example.com'"
  - "echo 'Production code v1' > app.js"
  - "git add app.js"
  - "git commit -m 'Initial production release'"
  - "git branch hotfix"
  - "echo 'Refactoring in progress...' > app.js"
  - "echo 'New module' > new-feature.js"
  - "git add new-feature.js"

# Scenario: app.js is modified (not staged), new-feature.js is staged
# Goal: stash everything, switch to hotfix, fix bug, come back, restore work

validation:
  checks:
    - type: "branch_exists"
      name: "hotfix"
      description: "Hotfix branch exists"
    - type: "current_branch"
      name: "main"
      description: "Back on main branch"
    - type: "file_content"
      path: "app.js"
      contains:
        - "Refactoring"
      description: "Refactoring work restored"
    - type: "commit_exists"
      message_pattern: ""
      description: "At least one commit exists"

hints:
  - "Use `git stash` to save your in-progress work (both staged and unstaged)."
  - "Switch to the hotfix branch with `git switch hotfix` or `git checkout hotfix`."
  - "After fixing and committing, switch back to main and use `git stash pop`."

scoring:
  time_bonus: true
  hint_penalty: 10
  max_score: 100

translations:
  ja:
    title: "ç·Šæ€¥ãƒ›ãƒƒãƒˆãƒ•ã‚£ãƒƒã‚¯ã‚¹"
    description: "å¤§è¦æ¨¡ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®æœ€ä¸­ã«ã€æœ¬ç•ªç’°å¢ƒã§ãƒã‚°ãŒç™ºè¦šã€‚ä½œæ¥­ã‚’é€€é¿ã—ã¦ã€ãƒã‚°ã‚’ä¿®æ­£ã—ã€å…ƒã®ä½œæ¥­ã«æˆ»ã£ã¦ãã ã•ã„ã€‚"
    hints:
      - "`git stash` ã§ä½œæ¥­ä¸­ã®å¤‰æ›´ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸æ¸ˆã¿ãƒ»æœªã‚¹ãƒ†ãƒ¼ã‚¸ä¸¡æ–¹ï¼‰ã‚’é€€é¿ã—ã¾ã™ã€‚"
      - "`git switch hotfix` ã§ãƒ›ãƒƒãƒˆãƒ•ã‚£ãƒƒã‚¯ã‚¹ãƒ–ãƒ©ãƒ³ãƒã«åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚"
      - "ä¿®æ­£ãƒ»ã‚³ãƒŸãƒƒãƒˆå¾Œã€mainã«æˆ»ã‚Š `git stash pop` ã§ä½œæ¥­ã‚’å¾©å…ƒã—ã¾ã™ã€‚"

summary: |
  ## ğŸ¯ Git Stash: The Emergency Escape
  
  | Command | What it does |
  |---------|--------------|
  | `git stash` | Save work-in-progress to a stack |
  | `git stash list` | View stashed changes |
  | `git stash pop` | Restore and remove from stack |
  | `git stash apply` | Restore but keep in stack |
